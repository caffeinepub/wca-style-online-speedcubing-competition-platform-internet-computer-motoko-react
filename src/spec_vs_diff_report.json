{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-11T23:58:46.861Z",
  "summary": "Diff implements user profile schema extension with country/gender and adds a migration module; frontend adds profile editing UI and updates leaderboard to display names via a new public-profiles fetch flow. However, backend public-profile query API and backend mutation changes are not evidenced in the provided (truncated) backend diff, so REQ-20 and parts of REQ-19/REQ-22 cannot be fully verified from the diff summary alone.",
  "missing_requirements": [
    {
      "id": "REQ-20",
      "requirement": "Provide a backend query API to fetch another user's public profile info (displayName, country, gender) by Principal without requiring the caller to be that user/admin, for leaderboard name resolution.",
      "reason": "Frontend changes reference fetching multiple public profiles, but the diff summary does not show any new/updated backend query method implementation (only types and migration are visible; backend/main.mo is truncated before methods).",
      "evidence": [
        "backend/main.mo (truncated)",
        "frontend/src/hooks/useQueries.ts (truncated)",
        "frontend/src/pages/LeaderboardPage.tsx",
        "frontend/src/api/queryKeys.ts"
      ]
    },
    {
      "id": "REQ-19",
      "requirement": "Update backend profile creation and save flows to initialize/persist country and gender, and ensure existing stored profiles can still be read safely after schema change.",
      "reason": "UserProfile type update and a migration module are present, but the diff summary does not show the implementations of createUserProfile and saveCallerUserProfile to confirm they initialize/persist the new fields (backend/main.mo is truncated before method bodies).",
      "evidence": [
        "backend/main.mo (truncated)",
        "backend/migration.mo",
        "frontend/src/hooks/useQueries.ts (truncated)"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Change to time formatting logic to treat 999999 and values >= 999999 as DNF.",
      "reason": "Not requested by any REQ (REQ-19..REQ-22 are about profile fields and leaderboard name resolution).",
      "evidence": [
        "frontend/src/lib/timeUtils.ts"
      ]
    }
  ],
  "confidence": 0.62,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/api/queryKeys.ts",
    "frontend/src/components/leaderboard/LeaderboardTable.tsx",
    "frontend/src/components/profile/ProfileMenu.tsx",
    "frontend/src/components/profile/ProfileSetupDialog.tsx",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/lib/timeUtils.ts",
    "frontend/src/pages/LeaderboardPage.tsx",
    "project_state.json"
  ]
}